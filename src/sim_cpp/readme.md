TODO: code readibility needs to be improved.